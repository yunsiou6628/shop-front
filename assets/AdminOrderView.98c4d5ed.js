import{Q as h,a as s}from"./QTable.e3f7646e.js";import{Q as v}from"./QBtn.c639a325.js";import{B as g,e as u,f as d,m as l,j as n,k as t,af as f,_ as p,a0 as i,F as b,$ as _,p as q,t as k}from"./index.c74ba9e5.js";import"./create.271cd6e4.js";import"./render.b33f033f.js";import"./Ripple.b95285a7.js";import"./QSeparator.3825c2fb.js";import"./use-dark.bf0b6226.js";import"./QList.4d156c3c.js";import"./QSelect.331897d5.js";import"./use-key-composition.5b22bb79.js";import"./QSpinner.dfa5743b.js";import"./focus-manager.d6507951.js";import"./QItem.b9e7c55f.js";import"./QMenu.78255d28.js";import"./selection.efe9ffa6.js";import"./focusout.7942feb4.js";import"./use-timeout.cbfe377c.js";import"./scroll.d4b28e8c.js";import"./QDialog.2f54c108.js";import"./rtl.4b414a6d.js";import"./use-fullscreen.570be918.js";const x={class:"q-pa-xl"},A=l("div",{class:"q-pb-xl"},[l("div",{class:"text-h5 text-center text-weight-bold",style:{color:"#5E8A4B"}},"\u8A02\u55AE\u7BA1\u7406")],-1),B={class:"col-12"},N={key:0},Q=k("\u522A\u9664"),Z={__name:"AdminOrderView",setup(V){const m=g([]),y=[{name:"_id",required:!0,label:"\u8A02\u55AEID",align:"left",field:r=>r._id,sortable:!0},{name:"user",required:!0,label:"\u6703\u54E1ID",align:"left",field:r=>{var a;return(a=r.user)==null?void 0:a._id},sortable:!0},{name:"name",required:!0,label:"\u6703\u54E1\u59D3\u540D",align:"left",sortable:!0},{name:"phone",required:!0,label:"\u6703\u54E1\u96FB\u8A71",align:"left",sortable:!0},{name:"products",required:!0,label:"\u8CFC\u8CB7\u5546\u54C1",align:"left",sortable:!0},{name:"quantity",required:!0,label:"\u8CFC\u8CB7\u6578\u91CF",align:"left",sortable:!0},{name:"PAY",required:!0,label:"\u4ED8\u6B3E\u65B9\u5F0F",align:"left",sortable:!0},{name:"cardname",required:!0,label:"\u6301\u5361\u4EBA\u59D3\u540D",align:"left",sortable:!0},{name:"PAYaccound",required:!0,label:"\u4ED8\u6B3E\u5E33\u865F / \u672B\u4E94\u78BC",align:"left",sortable:!0},{name:"edit",required:!0,label:"\u7DE8\u8F2F / \u522A\u9664",align:"left",sortable:!0}],w=async r=>{try{await f.delete("/orders/"+r),await p.fire({icon:"success",title:"\u522A\u9664\u6210\u529F"});const a=m.findIndex(e=>e._id===r);m.splice(a,1)}catch(a){p.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return(async()=>{try{const{data:r}=await f.get("/orders/all");m.push(...r.result.map(a=>(a.totalPrice=a.products.reduce((e,o)=>e+o.price*o.quantity,0),a))),console.log(r.result)}catch(r){console.log(r),p.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(r,a)=>(u(),d("div",x,[A,l("div",B,[n(h,{class:"text-grey-7",title:"\u8A02\u55AE\u8CC7\u6599",rows:m,columns:y,"row-key":"name",filter:r.filter},{"body-cell-name":t(e=>[n(s,null,{default:t(()=>[l("div",null,i(e.row.name),1)]),_:2},1024)]),"body-cell-phone":t(e=>[n(s,null,{default:t(()=>[l("div",null,i(e.row.phone),1)]),_:2},1024)]),"body-cell-products":t(e=>[n(s,null,{default:t(()=>[(u(!0),d(b,null,_(e.row.products,o=>{var c;return u(),d("div",{key:o},[l("div",null,i((c=o.product)==null?void 0:c.name),1)])}),128))]),_:2},1024)]),"body-cell-quantity":t(e=>[n(s,null,{default:t(()=>[(u(!0),d(b,null,_(e.row.products,o=>(u(),d("div",{key:o},[l("div",null,i(o.quantity),1)]))),128))]),_:2},1024)]),"body-cell-PAY":t(e=>[n(s,null,{default:t(()=>{var o,c;return[l("div",null,i((o=e.row.cardtype)==null?void 0:o.label),1),l("div",null,i((c=e.row.checkPay)==null?void 0:c.label),1),e.row.atmcheckDay?(u(),d("div",N,"ATM \u4ED8\u6B3E")):q("",!0)]}),_:2},1024)]),"body-cell-cardname":t(e=>[n(s,null,{default:t(()=>[l("div",null,i(e.row.cardname),1),l("div",null,i(e.row.checkName),1),l("div",null,i(e.row.atmcheckName),1)]),_:2},1024)]),"body-cell-PAYaccound":t(e=>[n(s,null,{default:t(()=>[l("div",null,i(e.row.cardnumber),1),l("div",null,i(e.row.checkAccount),1),l("div",null,i(e.row.atmcheckAccount),1)]),_:2},1024)]),"body-cell-edit":t(e=>[n(s,null,{default:t(()=>[n(v,{onClick:o=>w(e.row._id)},{default:t(()=>[Q]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["rows","filter"])])]))}};export{Z as default};
