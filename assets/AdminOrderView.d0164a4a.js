import{Q as h,a as u}from"./QTable.fd3975cf.js";import{Q as g}from"./QBtn.ff0e8fd9.js";import{B as k,e as s,f as c,m as l,j as n,k as t,ae as f,_ as m,a0 as i,F as b,$ as _,p as q,t as v}from"./index.5c8bc413.js";import"./render.cea28afc.js";import"./Ripple.9da1fea6.js";import"./QSeparator.6a579ecb.js";import"./use-dark.677526fb.js";import"./QList.3abf3bdf.js";import"./QSelect.b6a67d1b.js";import"./use-key-composition.e50d3c16.js";import"./QSpinner.bb07a5ed.js";import"./focus-manager.d6507951.js";import"./QItem.9e2137b4.js";import"./QMenu.33a6f125.js";import"./selection.00e0c602.js";import"./focusout.0f27e178.js";import"./use-timeout.5d988bcf.js";import"./scroll.1b2a8726.js";import"./QDialog.d5f9d141.js";import"./rtl.4b414a6d.js";import"./use-fullscreen.69b989b2.js";const x={class:"q-pa-xl"},A={class:"col-12"},N={key:0},B=v("\u522A\u9664"),X={__name:"AdminOrderView",setup(Q){const d=k([]),y=[{name:"_id",required:!0,label:"\u8A02\u55AEID",align:"left",field:a=>a._id,sortable:!0},{name:"user",required:!0,label:"\u6703\u54E1ID",align:"left",field:a=>{var r;return(r=a.user)==null?void 0:r._id},sortable:!0},{name:"name",required:!0,label:"\u6703\u54E1\u59D3\u540D",align:"left",sortable:!0},{name:"phone",required:!0,label:"\u6703\u54E1\u96FB\u8A71",align:"left",sortable:!0},{name:"products",required:!0,label:"\u8CFC\u8CB7\u5546\u54C1",align:"left",sortable:!0},{name:"quantity",required:!0,label:"\u8CFC\u8CB7\u6578\u91CF",align:"left",sortable:!0},{name:"PAY",required:!0,label:"\u4ED8\u6B3E\u65B9\u5F0F",align:"left",sortable:!0},{name:"cardname",required:!0,label:"\u6301\u5361\u4EBA\u59D3\u540D",align:"left",sortable:!0},{name:"PAYaccound",required:!0,label:"\u4ED8\u6B3E\u5E33\u865F / \u672B\u4E94\u78BC",align:"left",sortable:!0},{name:"edit",required:!0,label:"\u7DE8\u8F2F / \u522A\u9664",align:"left",sortable:!0}],w=async a=>{try{await f.delete("/orders/"+a),await m.fire({icon:"success",title:"\u522A\u9664\u6210\u529F"});const r=d.findIndex(e=>e._id===a);d.splice(r,1)}catch(r){m.fire({icon:"error",title:"\u5931\u6557",text:r.isAxiosError?r.response.data.message:r.message})}};return(async()=>{try{const{data:a}=await f.get("/orders/all");d.push(...a.result.map(r=>(r.totalPrice=r.products.reduce((e,o)=>e+o.product.price*o.quantity,0),r))),console.log(d)}catch(a){console.log(a),m.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(a,r)=>(s(),c("div",x,[l("div",A,[n(h,{title:"\u8A02\u55AE\u7BA1\u7406",rows:d,columns:y,"row-key":"name",filter:a.filter},{"body-cell-name":t(e=>[n(u,null,{default:t(()=>[l("pre",null,i(e.row.name),1)]),_:2},1024)]),"body-cell-phone":t(e=>[n(u,null,{default:t(()=>[l("pre",null,i(e.row.phone),1)]),_:2},1024)]),"body-cell-products":t(e=>[n(u,null,{default:t(()=>[(s(!0),c(b,null,_(e.row.products,o=>(s(),c("div",{key:o},[l("pre",null,i(o.product.name),1)]))),128))]),_:2},1024)]),"body-cell-quantity":t(e=>[n(u,null,{default:t(()=>[(s(!0),c(b,null,_(e.row.products,o=>(s(),c("div",{key:o},[l("pre",null,i(o.quantity),1)]))),128))]),_:2},1024)]),"body-cell-PAY":t(e=>[n(u,null,{default:t(()=>{var o,p;return[l("div",null,i((o=e.row.cardtype)==null?void 0:o.label),1),l("div",null,i((p=e.row.checkPay)==null?void 0:p.label),1),e.row.atmcheckDay?(s(),c("div",N,"ATM \u4ED8\u6B3E")):q("",!0)]}),_:2},1024)]),"body-cell-cardname":t(e=>[n(u,null,{default:t(()=>[l("div",null,i(e.row.cardname),1),l("div",null,i(e.row.checkName),1),l("div",null,i(e.row.atmcheckName),1)]),_:2},1024)]),"body-cell-PAYaccound":t(e=>[n(u,null,{default:t(()=>[l("div",null,i(e.row.cardnumber),1),l("div",null,i(e.row.checkAccount),1),l("div",null,i(e.row.atmcheckAccount),1)]),_:2},1024)]),"body-cell-edit":t(e=>[n(u,null,{default:t(()=>[n(g,{onClick:o=>w(e.row._id)},{default:t(()=>[B]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["rows","filter"])])]))}};export{X as default};
