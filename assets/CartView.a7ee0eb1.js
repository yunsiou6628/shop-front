import{Q as h,a as m}from"./QTable.6e322bae.js";import{Q as d}from"./QBtn.ef0e5e56.js";import{Q as v}from"./QCard.fa89971e.js";import{u as q,B as k,c as C,e as c,f as u,m as i,j as n,k as r,F as w,af as x,_ as D,t as l,a0 as a,$,p as f}from"./index.378566a4.js";import"./create.372fbcfd.js";import"./render.3cc31d86.js";import"./Ripple.9c46f039.js";import"./QSeparator.4915e9b2.js";import"./use-dark.1a0fc61f.js";import"./QList.e24eaa5d.js";import"./QSelect.4e8ce2ab.js";import"./use-key-composition.afd4dec2.js";import"./QSpinner.4b2f0e3f.js";import"./focus-manager.d6507951.js";import"./QItem.099e0acc.js";import"./QMenu.f660bdf5.js";import"./selection.e46da593.js";import"./focusout.fd6dd9f1.js";import"./use-timeout.b9818382.js";import"./scroll.f0d6a14f.js";import"./QDialog.7d6f80f3.js";import"./rtl.4b414a6d.js";import"./use-fullscreen.44b144d6.js";const B={class:"q-pa-xl gt-md",style:{width:"100%",height:"100%","background-image":"linear-gradient(to bottom,#F4F8EE, #fff)","z-index":"-1"}},I={class:"col-12"},S=["src"],E=l("\u522A\u9664"),L=l("-"),Q={class:"q-px-lg"},A=l("+"),V={class:"col-12 text-center q-pa-xl"},F={class:"col-12 q-py-sm"},N={class:"q-pa-xl lt-lg"},T={class:"col-12",style:{color:"#5E8A4B"}},j={key:0},O={img:"img"},z=["src"],U={class:"q-ma-lg"},G={key:0},H={key:1},J={key:2},K={class:"row"},M={class:"col-3",style:{margin:"auto 0"}},P=["btn"],R=l("- "),W={class:"q-px-lg"},X=l("+ "),Y={key:3},Z={key:4},tt={key:5,class:"row justify-center"},et=["btn"],ot=l("\u522A\u9664"),rt=["src"],it=l("\u522A\u9664"),nt=l("-"),at={class:"q-px-lg"},st=l("+"),dt={class:"col-12 text-center q-pa-xl"},lt={class:"col-12 q-py-sm"},Vt={__name:"CartView",setup(ct){const y=q(),p=k([]),g=[{name:"image",required:!0,label:"\u5716\u7247",align:"left"},{name:"product",required:!0,label:"\u884C\u7A0B\u540D\u7A31",align:"left",field:e=>{var s;return(s=e.product)==null?void 0:s.name},sortable:!0},{name:"product_date",required:!0,label:"\u884C\u7A0B\u65E5\u671F",align:"left",field:e=>e.product.name,sortable:!0},{name:"quantity",required:!0,label:"\u8CFC\u8CB7\u6578\u91CF",align:"left",field:e=>e.quantity,sortable:!0},{name:"price",required:!0,label:"\u50F9\u9322",align:"left",field:e=>{var s;return(s=e.product)==null?void 0:s.price},sortable:!0},{name:"subtotal",required:!0,label:"\u5C0F\u8A08",align:"left",field:e=>{var s;return((s=e.product)==null?void 0:s.price)*e.quantity},sortable:!0},{name:"btn",required:!0,label:"\u64CD\u4F5C",align:"left"}],_=async(e,s)=>{console.log(p[e].product._id),await y.updateCart({product:p[e].product._id,quantity:s})&&(s===0?p.splice(e,1):p[e].quantity=s)};return C(()=>p.reduce((e,s)=>e+s.product.price*s.quantity,0)),(async()=>{try{const{data:e}=await x.get("/users/cart");p.push(...e.result)}catch{D.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(e,s)=>(c(),u(w,null,[i("div",B,[i("div",I,[n(h,{title:"\u5DF2\u52A0\u5165\u884C\u7A0B",rows:p,columns:g,"row-key":"name","hide-pagination":"",style:{color:"#5E8A4B","font-weight":"bolder"}},{"body-cell-image":r(t=>[n(m,{img:e.img},{default:r(()=>{var o;return[i("img",{src:(o=t.row.product)==null?void 0:o.image,style:{width:"200px"}},null,8,S)]}),_:2},1032,["img"])]),"body-cell-product_date":r(t=>[n(m,{product_date:e.product_date},{default:r(()=>{var o,b;return[l(a(new Date((o=t.row.product)==null?void 0:o.product_date.from).toLocaleDateString())+" ~ "+a(new Date((b=t.row.product)==null?void 0:b.product_date.to).toLocaleDateString()),1)]}),_:2},1032,["product_date"])]),"body-cell-btn":r(t=>[n(m,{btn:e.btn},{default:r(()=>[n(d,{onClick:o=>_(t.rowIndex,0)},{default:r(()=>[E]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),"body-cell-quantity":r(t=>[n(m,{btn:e.btn},{default:r(()=>[n(d,{onClick:o=>_(t.rowIndex,t.row.quantity-1)},{default:r(()=>[L]),_:2},1032,["onClick"]),i("span",Q,a(t.row.quantity),1),n(d,{onClick:o=>_(t.rowIndex,t.row.quantity+1)},{default:r(()=>[A]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),_:1},8,["rows"])]),i("div",V,[i("div",F,[n(d,{to:"/ConfirmOrder",style:{color:"#fff",background:"#5E8A4B"},label:"\u78BA\u8A8D"})])])]),i("div",N,[i("div",T,[n(h,{grid:e.$q.screen.lt.md,title:"\u5DF2\u52A0\u5165\u884C\u7A0B",rows:p,columns:g,"row-key":"name","hide-pagination":"",style:{color:"#5E8A4B","font-weight":"bolder"}},{item:r(t=>[n(v,{class:"col-12 q-pa-md q-my-lg text-weight-bold text-grey-7"},{default:r(()=>[(c(!0),u(w,null,$(t.cols,o=>(c(),u("div",{key:o.name},[o.name==="image"?(c(),u("div",j,[i("div",O,[i("img",{src:t.row.product.image,style:{width:"100%"}},null,8,z)])])):f("",!0),i("div",U,[o.name==="product"?(c(),u("div",G,[i("div",null,a(o.label)+" : "+a(o.value),1)])):f("",!0),o.name==="product_date"?(c(),u("div",H,[i("div",null,a(o.label)+" : "+a(new Date(t.row.product.product_date.from).toLocaleDateString())+" ~ "+a(new Date(t.row.product.product_date.to).toLocaleDateString()),1)])):f("",!0),o.name==="quantity"?(c(),u("div",J,[i("div",K,[i("div",M,a(o.label)+" : ",1),i("div",{btn:e.btn,class:"col-7"},[n(d,{flat:"",round:"",onClick:b=>_(t.rowIndex,t.row.quantity-1),style:{width:"10%"}},{default:r(()=>[R]),_:2},1032,["onClick"]),i("span",W,a(t.row.quantity),1),n(d,{flat:"",round:"",onClick:b=>_(t.rowIndex,t.row.quantity+1),style:{width:"10%"}},{default:r(()=>[X]),_:2},1032,["onClick"])],8,P)])])):f("",!0),o.name==="price"?(c(),u("div",Y,[i("div",null,a(o.label)+" : "+a(o.value),1)])):f("",!0),o.name==="subtotal"?(c(),u("div",Z,[i("div",null,a(o.label)+" : "+a(o.value),1)])):f("",!0),o.name==="btn"?(c(),u("div",tt,[i("div",{btn:e.btn},[n(d,{onClick:b=>_(t.rowIndex,0)},{default:r(()=>[ot]),_:2},1032,["onClick"])],8,et)])):f("",!0)])]))),128))]),_:2},1024)]),"body-cell-image":r(t=>[n(m,{img:e.img},{default:r(()=>[i("img",{src:t.row.product.image,style:{width:"200px"}},null,8,rt)]),_:2},1032,["img"])]),"body-cell-product_date":r(t=>[n(m,{product_date:e.product_date},{default:r(()=>[l(a(new Date(t.row.product.product_date.from).toLocaleDateString())+" ~ "+a(new Date(t.row.product.product_date.to).toLocaleDateString()),1)]),_:2},1032,["product_date"])]),"body-cell-btn":r(t=>[n(m,{btn:e.btn},{default:r(()=>[n(d,{onClick:o=>_(t.rowIndex,0)},{default:r(()=>[it]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),"body-cell-quantity":r(t=>[n(m,{btn:e.btn},{default:r(()=>[n(d,{onClick:o=>_(t.rowIndex,t.row.quantity-1)},{default:r(()=>[nt]),_:2},1032,["onClick"]),i("span",at,a(t.row.quantity),1),n(d,{onClick:o=>_(t.rowIndex,t.row.quantity+1)},{default:r(()=>[st]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),_:1},8,["grid","rows"])]),i("div",dt,[i("div",lt,[n(d,{to:"/ConfirmOrder",label:"\u78BA\u8A8D",style:{background:"#5E8A4B",color:"#fff"}})])])])],64))}};export{Vt as default};
