import{Q as c}from"./QTd.d8dc7972.js";import{Q as a}from"./QBtn.fd74b821.js";import{Q as p}from"./QTable.a010ac57.js";import{u as b,B as g,c as h,b as y,e as w,m as i,f as r,j as o,F as q,af as C,$ as k,a1 as _,t as d}from"./index.29aa1ca1.js";import"./render.1af6db0b.js";import"./Ripple.15150790.js";import"./QSpinner.1e7c4006.js";import"./QSeparator.dae6cbb7.js";import"./use-dark.986dc809.js";import"./QList.87bfc951.js";import"./QSelect.43f3a02d.js";import"./use-key-composition.0dd64b41.js";import"./focus-manager.d6507951.js";import"./QItem.f8683545.js";import"./QMenu.1efc5691.js";import"./selection.cc46c2a0.js";import"./focusout.de0b4893.js";import"./use-timeout.c83cb5b2.js";import"./scroll.5775526a.js";import"./QDialog.e4067997.js";import"./rtl.4b414a6d.js";import"./use-fullscreen.268f54f0.js";const v={class:"q-pa-xl gt-md",style:{width:"100vw",height:"100vh","background-image":"linear-gradient(to bottom,#F4F8EE, #fff)","z-index":"-1"}},x={class:"col-12"},$=["src"],I=d("\u522A\u9664"),Q=d("-"),B={class:"q-px-lg"},F=d("+"),V={class:"col-12 text-center q-pa-xl"},E={class:"col-12 q-py-sm"},N={class:"q-pa-xl lt-lg"},S={class:"col-12"},T=["src"],O=d("\u522A\u9664"),j=d("-"),z={class:"q-px-lg"},A=d("+"),D={class:"col-12 text-center q-pa-xl"},U={class:"col-12 q-py-sm"},mt={__name:"CartView",setup(G){const f=b(),n=g([]),m=[{name:"image",required:!0,label:"\u5546\u54C1\u5716\u7247",align:"left"},{name:"product",required:!0,label:"\u8CFC\u8CB7\u5546\u54C1",align:"left",field:t=>t.product.name,format:t=>`${t}`,sortable:!0},{name:"quantity",required:!0,label:"\u8CFC\u8CB7\u6578\u91CF",align:"left",field:t=>t.quantity,format:t=>`${t}`},{name:"price",required:!0,label:"\u50F9\u9322",align:"left",field:t=>t.product.price,format:t=>`${t}`,sortable:!0},{name:"subtotal",required:!0,label:"\u5C0F\u8A08",align:"left",field:t=>t.product.price*t.quantity,sortable:!0},{name:"btn",required:!0,label:"\u64CD\u4F5C",align:"left"}],l=async(t,s)=>{console.log(n[t].product._id),await f.updateCart({product:n[t].product._id,quantity:s})&&(s===0?n.splice(t,1):n[t].quantity=s)};return h(()=>n.reduce((t,s)=>t+s.product.price*s.quantity,0)),(async()=>{try{const{data:t}=await C.get("/users/cart");n.push(...t.result)}catch{k.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(t,s)=>(y(),w(q,null,[i("div",v,[i("div",x,[r(p,{title:"\u5DF2\u52A0\u5165\u884C\u7A0B",rows:n,columns:m,"row-key":"name","hide-pagination":""},{"body-cell-image":o(e=>[r(c,{img:t.img},{default:o(()=>[i("img",{src:e.row.product.image,style:{width:"200px"}},null,8,$)]),_:2},1032,["img"])]),"body-cell-btn":o(e=>[r(c,{btn:t.btn},{default:o(()=>[r(a,{onClick:u=>l(e.rowIndex,0)},{default:o(()=>[I]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),"body-cell-quantity":o(e=>[r(c,{btn:t.btn},{default:o(()=>[r(a,{onClick:u=>l(e.rowIndex,e.row.quantity-1)},{default:o(()=>[Q]),_:2},1032,["onClick"]),i("span",B,_(e.row.quantity),1),r(a,{onClick:u=>l(e.rowIndex,e.row.quantity+1)},{default:o(()=>[F]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),_:1},8,["rows"])]),i("div",V,[i("div",E,[r(a,{color:"primary",to:"/ConfirmOrder",label:"\u78BA\u8A8D"})])])]),i("div",N,[i("div",S,[r(p,{grid:t.$q.screen.lt.md,title:"\u5DF2\u52A0\u5165\u884C\u7A0B",rows:n,columns:m,"row-key":"name","hide-pagination":""},{"body-cell-image":o(e=>[r(c,{img:t.img},{default:o(()=>[i("img",{src:e.row.product.image,style:{width:"200px"}},null,8,T)]),_:2},1032,["img"])]),"body-cell-btn":o(e=>[r(c,{btn:t.btn},{default:o(()=>[r(a,{onClick:u=>l(e.rowIndex,0)},{default:o(()=>[O]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),"body-cell-quantity":o(e=>[r(c,{btn:t.btn},{default:o(()=>[r(a,{onClick:u=>l(e.rowIndex,e.row.quantity-1)},{default:o(()=>[j]),_:2},1032,["onClick"]),i("span",z,_(e.row.quantity),1),r(a,{onClick:u=>l(e.rowIndex,e.row.quantity+1)},{default:o(()=>[A]),_:2},1032,["onClick"])]),_:2},1032,["btn"])]),_:1},8,["grid","rows"])]),i("div",D,[i("div",U,[r(a,{color:"primary",to:"/ConfirmOrder",label:"\u78BA\u8A8D"})])])])],64))}};export{mt as default};
